{
  "templateName": "Dating Sim Tracker (Right w/ Tabs)",
  "templateAuthor": "Prolix OCs",
  "templatePosition": "RIGHT",
  "htmlTemplate": "<!-- TEMPLATE NAME: Dating Sim Tracker (Right Side with Tabs) -->\n<!-- AUTHOR: Prolix OCs -->\n<!-- POSITION: RIGHT -->\n\n<!-- CARD_TEMPLATE_START -->\n<style>\n  /* The actual template styling */\n  .sim-tracker-container {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n    width: 100%;\n    position: relative;\n    height: 100%;\n    pointer-events: none !important;\n  }\n\n  /* Both tabs and cards exist in the same grid cell, naturally layered */\n  .sim-tracker-tabs,\n  .sim-tracker-cards-wrapper {\n    grid-column: 1;\n    grid-row: 1;\n    position: relative;\n    height: 100%;\n    width: 100%;\n    pointer-events: none !important;\n  }\n\n  .sim-tracker-tabs {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    justify-content: center;\n    align-items: flex-end;\n    padding-right: 0;\n    width: auto;\n    height: 100%;\n    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\n    pointer-events: none !important;\n  }\n\n  .sim-tracker-tab {\n    width: 60px;\n    height: 60px;\n    border-radius: 8px;\n    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);\n    backdrop-filter: blur(10px);\n    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), filter 0.3s ease;\n    cursor: pointer;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background: linear-gradient(145deg, #2c2c2c, #1a1a1a);\n    border: 1px solid rgba(255, 255, 255, 0.05);\n    flex-shrink: 0;\n    margin-right: 8px;\n    pointer-events: auto !important;\n    position: relative;\n  }\n\n  .sim-tracker-tab.active {\n    transform: translateX(-270px);  /* Move into view with card */\n    filter: brightness(1.3) !important;\n  }\n\n  .sim-tracker-tab:hover {\n    filter: brightness(1.2) !important;\n  }\n\n  .tab-initials {\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    background: linear-gradient(145deg, #6a5acd, #5a4abc);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-weight: bold;\n    font-size: 18px;\n  }\n\n  .sim-tracker-cards-wrapper {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    pointer-events: none !important;\n  }\n\n  .sim-tracker-card {\n    background: linear-gradient(145deg, #2c2c2c, #1a1a1a);\n    border-radius: 18px;\n    padding: 20px;\n    width: 270px;\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n    position: absolute !important;\n    right: 0 !important;\n    top: 50%;\n    backdrop-filter: blur(10px);\n    transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.3s ease, visibility 0.3s ease;\n    transform: translateY(-50%) translateX(100%) !important;\n    opacity: 0;\n    visibility: hidden;\n    border: 1px solid rgba(255, 255, 255, 0.05);\n    overflow: hidden;\n    pointer-events: auto !important;\n  }\n\n  .sim-tracker-card.active {\n    transform: translateY(-50%) translateX(0) !important;\n    opacity: 1;\n    visibility: visible;\n  }\n\n  .sim-tracker-card.sliding-out {\n    transform: translateY(-50%) translateX(100%) !important;\n    opacity: 0;\n    visibility: hidden;\n  }\n\n  .sim-tracker-card.tab-hidden {\n    display: none !important;\n  }\n\n  .sim-tracker-card.inactive {\n    opacity: 1;\n  }\n\n  .sim-tracker-card.inactive.active {\n    opacity: 1;\n  }\n\n  .character-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 18px;\n  }\n\n  .character-name {\n    font-size: 1.3em;\n    font-weight: 600;\n    color: #ffffff;\n  }\n\n  .status-indicator {\n    font-size: 1.4em;\n  }\n\n  .stats-container {\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n  }\n\n  .stat-item {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n  }\n\n  .stat-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    font-size: 0.9em;\n    color: rgba(255, 255, 255, 0.7);\n  }\n\n  .stat-value-wrapper {\n    display: flex;\n    align-items: center;\n  }\n\n  .stat-bar-bg {\n    height: 8px;\n    background: rgba(255, 255, 255, 0.1);\n    border-radius: 4px;\n    overflow: hidden;\n  }\n\n  .stat-bar-fill {\n    height: 100%;\n    border-radius: 4px;\n  }\n\n  .status-container {\n    margin-top: 20px;\n    padding-top: 16px;\n    border-top: 1px solid rgba(255, 255, 255, 0.05);\n  }\n\n  .relationship-status,\n  .desire-status {\n    margin-bottom: 10px;\n    font-size: 0.95em;\n    color: rgba(255, 255, 255, 0.9);\n  }\n\n  .days-counter {\n    text-align: left;\n    font-style: italic;\n    color: rgba(255, 255, 255, 0.8);\n    font-size: 1em;\n    margin-bottom: 15px;\n    padding-bottom: 10px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n    align-items: center;\n  }\n\n  .header-badge {\n    padding: 4px 8px;\n    border-radius: 6px;\n    font-weight: 500;\n    font-size: 0.85em;\n    font-style: normal;\n    letter-spacing: 0.25px;\n    background: rgba(0, 0, 0, 0.2) !important;\n    border: 1px solid rgba(255, 255, 255, 0.08) !important;\n    backdrop-filter: blur(8px) !important;\n  }\n\n  .change-indicator {\n    color: white;\n    font-size: 0.75em;\n    font-weight: 600;\n    padding: 2px 5px;\n    border-radius: 4px;\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    min-width: 20px;\n    text-align: center;\n    line-height: 1.2;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n    margin-left: 6px;\n  }\n\n  .change-indicator.positive {\n    background: rgba(46, 204, 113, 0.9) !important;\n  }\n\n  .change-indicator.negative {\n    background: rgba(231, 76, 60, 0.9) !important;\n  }\n\n  .change-indicator.negative-alt {\n    background: rgba(46, 204, 113, 0.9) !important;\n  }\n\n  .thought-bubble {\n    margin-top: 6px;\n    padding: 15px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 12px;\n    border: 1px solid rgba(255, 255, 255, 0.08);\n  }\n\n  .thought-label {\n    position: relative;\n    padding-top: 8px;\n    font-size: 11px;\n    font-weight: 500;\n    color: rgba(255, 255, 255, 0.7);\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n    letter-spacing: 0.25px;\n  }\n\n  /* Overlay for inactive characters */\n  .narrative-inactive-overlay {\n    position: absolute;\n    top: -5px;\n    left: -5px;\n    width: calc(100% + 10px);\n    height: calc(100% + 10px);\n    background-color: black;\n    opacity: 0.5;\n    border-radius: 18px;\n    display: none;\n    z-index: 100; /* High z-index to cover all content */\n    pointer-events: none; /* Allow clicks to pass through to underlying elements */\n  }\n\n  .narrative-inactive .narrative-inactive-overlay {\n    display: block;\n  }\n</style>\n\n<div class=\"sim-tracker-container\">\n  <div class=\"sim-tracker-tabs\">\n    {{#each characters}}\n    <div\n      class=\"sim-tracker-tab\"\n      data-character=\"{{@index}}\"\n      style=\"background: linear-gradient(145deg, {{adjustColorBrightness bgColor 70}} 0%, {{adjustColorBrightness darkerBgColor 60}} 50%, {{adjustColorBrightness darkerBgColor 50}} 100%);\"\n    >\n      <div\n        class=\"tab-initials\"\n        style=\"background: linear-gradient(145deg, {{adjustColorBrightness bgColor 90}} 0%, {{adjustColorBrightness bgColor 70}} 100%);\"\n      >\n        {{initials characterName}}\n      </div>\n    </div>\n    {{/each}}\n  </div>\n\n  <div class=\"sim-tracker-cards-wrapper\">\n    {{#each characters}}\n    <div\n      class=\"sim-tracker-card {{#if stats.inactive}}narrative-inactive{{/if}}\"\n      data-character=\"{{@index}}\"\n      style=\"background: linear-gradient(145deg, {{adjustColorBrightness bgColor 70}} 0%, {{adjustColorBrightness darkerBgColor 60}} 50%, {{adjustColorBrightness darkerBgColor 50}} 100%);\"\n    >\n      <!-- Overlay for inactive characters -->\n      <div class=\"narrative-inactive-overlay\"></div>\n\n      <!-- Days counter at the top -->\n      <div class=\"days-counter\">\n        <span class=\"header-badge\">{{currentDate}}</span>\n        <span class=\"header-badge\">Day {{stats.days_since_first_meeting}}</span>\n        {{#if stats.preg}}<span class=\"header-badge\">ü§∞{{stats.days_preg}}d</span>{{/if}}\n      </div>\n\n      <!-- Character header with name and status -->\n      <div class=\"character-header\">\n        <div class=\"character-name\">{{characterName}}</div>\n        <div class=\"status-indicator\">\n          {{#if stats.inactive}} üí§ {{else}} {{#if (gt stats.ap 70)}} üòä {{else\n          if (gt stats.ap 40)}} üòê {{else}} üòû {{/if}} {{/if}}\n        </div>\n      </div>\n\n      <!-- Stats grid with progress bars -->\n      <div class=\"stats-container\">\n        <!-- Affection -->\n        <div class=\"stat-item\">\n          <div class=\"stat-header\">\n            <span>Affection</span>\n            <span class=\"stat-value-wrapper\">\n              <span>{{stats.ap}}</span>\n              {{#if stats.apChange}}{{#unless (eq stats.apChange 0)}}\n              <span class=\"change-indicator positive\">\n                {{#if (gt stats.apChange 0)}}+{{/if}}{{stats.apChange}}\n              </span>\n              {{/unless}}{{/if}}\n            </span>\n          </div>\n          <div class=\"stat-bar-bg\">\n            <div\n              class=\"stat-bar-fill\"\n              style=\"width: {{#if (gt stats.ap 200)}}100{{else}}{{#if stats.ap}}{{divide stats.ap 2}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #ff9a9e, #fad0c4); border-radius: 4px;\"\n            ></div>\n          </div>\n        </div>\n\n        <!-- Desire -->\n        <div class=\"stat-item\">\n          <div class=\"stat-header\">\n            <span>Desire</span>\n            <span class=\"stat-value-wrapper\">\n              <span>{{stats.dp}}</span>\n              {{#if stats.dpChange}}{{#unless (eq stats.dpChange 0)}}\n              <span class=\"change-indicator negative\">\n                {{#if (gt stats.dpChange 0)}}+{{/if}}{{stats.dpChange}}\n              </span>\n              {{/unless}}{{/if}}\n            </span>\n          </div>\n          <div class=\"stat-bar-bg\">\n            <div\n              class=\"stat-bar-fill\"\n              style=\"width: {{#if (gt stats.dp 150)}}100{{else}}{{#if stats.dp}}{{divideRoundUp stats.dp 1.5}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #a1c4fd, #c2e9fb); border-radius: 4px;\"\n            ></div>\n          </div>\n        </div>\n\n        <!-- Trust -->\n        <div class=\"stat-item\">\n          <div class=\"stat-header\">\n            <span>Trust</span>\n            <span class=\"stat-value-wrapper\">\n              <span>{{stats.tp}}</span>\n              {{#if stats.tpChange}}{{#unless (eq stats.tpChange 0)}}\n              <span class=\"change-indicator positive\">\n                {{#if (gt stats.tpChange 0)}}+{{/if}}{{stats.tpChange}}\n              </span>\n              {{/unless}}{{/if}}\n            </span>\n          </div>\n          <div class=\"stat-bar-bg\">\n            <div\n              class=\"stat-bar-fill\"\n              style=\"width: {{#if (gt stats.tp 150)}}100{{else}}{{#if stats.tp}}{{divideRoundUp stats.tp 1.5}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #84fab0, #8fd3f4); border-radius: 4px;\"\n            ></div>\n          </div>\n        </div>\n\n        <!-- Contempt -->\n        <div class=\"stat-item\">\n          <div class=\"stat-header\">\n            <span>Contempt</span>\n            <span class=\"stat-value-wrapper\">\n              <span>{{stats.cp}}</span>\n              {{#if stats.cpChange}}{{#unless (eq stats.cpChange 0)}}\n              <span class=\"change-indicator negative-alt\">\n                {{#if (gt stats.cpChange 0)}}+{{/if}}{{stats.cpChange}}\n              </span>\n              {{/unless}}{{/if}}\n            </span>\n          </div>\n          <div class=\"stat-bar-bg\">\n            <div\n              class=\"stat-bar-fill\"\n              style=\"width: {{#if (gt stats.cp 150)}}100{{else}}{{#if stats.cp}}{{divideRoundUp stats.cp 1.5}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #d4fc79, #96e6a1); border-radius: 4px;\"\n            ></div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Status -->\n      <div class=\"status-container\">\n        <div class=\"relationship-status\">\n          <strong>Relationship:</strong> {{stats.relationshipStatus}}\n        </div>\n        <div class=\"desire-status\">\n          <strong>Desire:</strong> {{stats.desireStatus}}\n        </div>\n      </div>\n\n      <!-- Internal thought bubble (conditionally shown) -->\n      {{#if stats.internal_thought}}\n      <div class=\"thought-label\">Thinks:</div>\n      <div class=\"thought-bubble\">\n        <div style=\"display: flex; align-items: flex-start; gap: 10px\">\n          <div style=\"font-size: 1.2em; flex-shrink: 0\">üí≠</div>\n          <div\n            style=\"\n              font-size: 0.95em;\n              line-height: 1.4;\n              color: rgba(255, 255, 255, 0.85);\n            \"\n          >\n            {{stats.internal_thought}}\n          </div>\n        </div>\n      </div>\n      {{/if}}\n    </div>\n    {{/each}}\n  </div>\n</div>\n<!-- CARD_TEMPLATE_END -->\n\n  <!-- \nTEMPLATE VARIABLES:\n- {{characters}}: Array of character objects with their data\n- {{characterName}}: Character's name\n- {{currentDate}}: Current date in YYYY-MM-DD format\n- {{bgColor}}: Primary background color\n- {{darkerBgColor}}: Darker variant of background color\n- {{contrastColor}}: Contrast color for text against background\n- {{stats.ap}}: Affection points (max 200)\n- {{stats.dp}}: Desire points (max 150)\n- {{stats.tp}}: Trust points (max 150)\n- {{stats.cp}}: Contempt points (max 150)\n- {{stats.apChange}}: Change in affection points (positive/negative/zero)\n- {{stats.dpChange}}: Change in desire points (positive/negative/zero)\n- {{stats.tpChange}}: Change in trust points (positive/negative/zero)\n- {{stats.cpChange}}: Change in contempt points (positive/negative/zero)\n- {{stats.days_since_first_meeting}}: Days since first meeting\n- {{stats.preg}}: Boolean for pregnancy status\n- {{stats.days_preg}}: Days pregnant (if applicable)\n- {{stats.internal_thought}}: Character's internal thoughts\n- {{stats.relationshipStatus}}: Relationship status text\n- {{stats.desireStatus}}: Desire status text\n- {{stats.inactive}}: Boolean for inactive status\n- {{stats.inactiveReason}}: Number indicating reason for inactivity (0-5)\n- {{healthIcon}}: Health status icon (ü§ï or üíÄ)\n- {{reactionEmoji}}: Reaction emoji (üëç, üëé, or üòê)\n- {{showThoughtBubble}}: Boolean to show/hide thought bubble\n-->",
  "sysPrompt": "## DATING SIM MODE\n\n**Objective**: Prioritize narrative reality for relationship updates. Analyze context to determine current date (YYYY-MM-DD) and time (24h format). Update trackers when events occur. Check for `sim` codeblocks containing JSON/YAML. Recalculate missing data.\n\n## Core Systems\n\n### Output Rules\n\n1. **Order**: Narrative ‚Üí Tracker ‚Üí Sim codeblock (NEVER omit sim codeblock)\n2. **Multi-Character**: Generate ONE card per active character, track separately\n3. **Performance**: Max 4 active characters, collapse inactive, preserve all states\n\n### Relationship Meters\n\n**HARD CAPS**: All meters have ABSOLUTE MAXIMUM values that CANNOT be exceeded under any circumstances. Values must stay within their defined ranges.\n\n**Affection (AP)**: 0-200 (HARD CAP at 200) - Romantic feelings toward {{user}}. Higher = more affectionate behavior/speech.\n- 0-30: Strangers | 31-60: Acquaintances | 61-90: Good Friends\n- 91-120: Romantic Interest | 121-150: Going Steady\n- 151-180: Committed Relationship | 181-200: Devoted Partner\n- **Status strings are CONCRETE and MUST NOT be altered or substituted with custom text**\n\n**Desire (DP)**: 0-150 (HARD CAP at 150) - Sexual attraction. Higher = more willing to engage sexually, more pliable at max.\n- 0-25: Not feeling the heat | 26-50: A smoldering flame builds\n- 51-75: Starting to feel warm | 76-100: Body's burning up!\n- 101-125: A desperate need presents | 126-150: Pliable in the lustful hunger\n- **Status strings are CONCRETE and MUST NOT be altered or substituted with custom text**\n\n**Trust (TP)**: 0-150 (HARD CAP at 150) - Trust in {{user}}. Higher = admits faults, believes you. Falls when lied to, cheated, promises broken.\n\n**Contempt (CP)**: 0-150 (HARD CAP at 150) - Disdain toward {{user}}. Rises when harmed/hurt (minor = small rise, major = sharp rise). CP rise can lower other stats. Good faith/regret can lower CP.\n\n### Status Trackers\n\n**Change Tracking** (from user's most recent action):\n- apChange, dpChange, tpChange, cpChange: Numeric change (+/-/0)\n\n**Health**: 0=Unharmed, 1=Injured, 2=Critical\n- If critical wounds untreated: Character dies, becomes inactive (5), STOP dialog/roleplay\n\n**Reaction**: 0=Neutral (üòê), 1=Like (üëç), 2=Dislike (üëé)\n\n**Pregnancy**: Track conception days when relevant (ü§∞[days]d)\n- **Conception Risk**: When raw, unprotected sex occurs, apply VERY HIGH likelihood of conception (85-95% chance)\n- **Natural Cycles**: Follow the natural pregnancy cycle of {{char}}'s species\n- **Early Pregnancy**: Signs of pregnancy typically do NOT appear until 3-4 weeks after conception for most species\n- Track from conception date, display days pregnant once confirmed\n\n**Internal Thought**: Current thoughts/feelings. MAXIMUM 3 SENTENCES. NEVER exceed this limit. Do NOT wrap thoughts in asterisks.\n\n**Inactive Status** (`inactive: true/false`):\n- 0: Not inactive | 1: Asleep (üò¥) | 2: Comatose (üè•)\n- 3: Contempt/anger (üò°) | 4: Incapacitated (ü´†) | 5: Death (ü™¶)\n\n**Date System**:\n- Infer from narrative context\n- Store as YYYY-MM-DD (e.g., 2025-08-10)\n- Auto-advance with narrative time, handle rollovers\n- Track days since first meeting\n- Track time of day realistically\n\n**Display**: Day counter (starts at 1), BG color (hex based on {{char}} appearance/personality)\n\n### Output Workflow\n\n1. Process narrative events\n2. Calculate status changes for ALL active characters\n3. Output narrative content\n4. Output sim codeblock with all character data:\n\n{{sim_format}}\n\n## Critical Enforcement\n\n**Position Lock**:\n- Narrative FIRST\n- Tracker cards AFTER narrative\n- Sim codeblock LAST\n- NEVER exclude sim codeblock\n\n**Data Correction**:\n- If ANY data missing from previous sim block, add it and continue\n- Never leave data empty/unavailable\n- JSON block at message end is mission critical\n- If previous data doesn't match format or has missing keys, self-correct and output fixed block\n\n**Game Master**: Only story characters get trackers, no other assistants or {{user}} will get one under any circumstances.\n\n**State Management**: \n- Previous tracker blocks = reference only\n- ALWAYS generate fresh tracker data each message\n",
  "customFields": [
    {
      "key": "ap",
      "description": "Affection Points (0-200)"
    },
    {
      "key": "dp",
      "description": "Desire Points (0-150)"
    },
    {
      "key": "tp",
      "description": "Trust Points (0-150)"
    },
    {
      "key": "cp",
      "description": "Contempt Points (0-150)"
    },
    {
      "key": "apChange",
      "description": "Change in Affection from last action (positive/negative/zero)"
    },
    {
      "key": "dpChange",
      "description": "Change in Desire from last action (positive/negative/zero)"
    },
    {
      "key": "tpChange",
      "description": "Change in Trust from last action (positive/negative/zero)"
    },
    {
      "key": "cpChange",
      "description": "Change in Contempt from last action (positive/negative/zero)"
    },
    {
      "key": "relationshipStatus",
      "description": "Relationship status text (e.g., 'Romantic Interest')"
    },
    {
      "key": "desireStatus",
      "description": "Desire status text (e.g., 'A smoldering flame builds.')"
    },
    {
      "key": "preg",
      "description": "Boolean for pregnancy status (true/false)"
    },
    {
      "key": "days_preg",
      "description": "Days pregnant (if applicable)"
    },
    {
      "key": "conception_date",
      "description": "Date of conception (YYYY-MM-DD)"
    },
    {
      "key": "health",
      "description": "Health Status (0=Unharmed, 1=Injured, 2=Critical)"
    },
    {
      "key": "bg",
      "description": "Hex color for card background (e.g., #6a5acd)"
    },
    {
      "key": "last_react",
      "description": "Reaction to User (0=Neutral, 1=Like, 2=Dislike)"
    },
    {
      "key": "internal_thought",
      "description": "Character's current internal thoughts/feelings"
    },
    {
      "key": "days_since_first_meeting",
      "description": "Total days since first meeting"
    },
    {
      "key": "inactive",
      "description": "Boolean for character inactivity (true/false)"
    },
    {
      "key": "inactiveReason",
      "description": "Reason for inactivity (0=Not inactive, 1=Asleep, 2=Comatose, 3=Contempt/anger, 4=Incapacitated, 5=Death)"
    }
  ],
  "extSettings": {
    "codeBlockIdentifier": "sim",
    "defaultBgColor": "#6a5acd",
    "showThoughtBubble": true,
    "hideSimBlocks": true,
    "templateFile": "dating-card-template-sidebar-tabs.html"
  },
  "trackerDesc": "romantic encounter with slow burn focus."
}
