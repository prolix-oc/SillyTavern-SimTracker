{
  "templateName": "Dating Sim Tracker (Right w/ Tabs)",
  "templateAuthor": "Prolix OCs",
  "templatePosition": "RIGHT",
  "htmlTemplate": "<!-- TEMPLATE NAME: Dating Sim Tracker (Right Side with Tabs) -->\r\n<!-- AUTHOR: Prolix OCs -->\r\n<!-- POSITION: RIGHT -->\r\n\r\n<!-- CARD_TEMPLATE_START -->\r\n<style>\r\n  /* The actual template styling */\r\n  .sim-tracker-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 20px;\r\n    width: 100%;\r\n    position: relative;\r\n    height: 100%;\r\n    pointer-events: none;\r\n  }\r\n\r\n  .sim-tracker-tabs {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 12px;\r\n    position: absolute;\r\n    right: 0; /* Position tabs at the edge of the screen */\r\n    top: 0;\r\n    bottom: 0;\r\n    justify-content: center;\r\n    height: 100%;\r\n    z-index: 10; /* Lower z-index so tabs are behind cards */\r\n    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\r\n    pointer-events: auto;\r\n  }\r\n\r\n  .sim-tracker-tab {\r\n    width: 60px;\r\n    height: 60px;\r\n    border-radius: 8px;\r\n    box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);\r\n    position: relative;\r\n    backdrop-filter: blur(10px);\r\n    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\r\n    cursor: pointer;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    background: linear-gradient(145deg, #2c2c2c, #1a1a1a);\r\n    border: 1px solid rgba(255, 255, 255, 0.05);\r\n    flex-shrink: 0;\r\n    margin: 0 8px; /* Add some horizontal spacing */\r\n    transform: translateX(60px); /* Start hidden at the edge of the screen */\r\n    z-index: 10; /* Lower z-index so tabs are behind cards */\r\n    pointer-events: auto;\r\n  }\r\n\r\n  .sim-tracker-tab.active {\r\n    transform: translateX(-270px); /* Animate to aligned position (card width) */\r\n    z-index: 20; /* Higher z-index for active tab */\r\n  }\r\n\r\n  .tab-initials {\r\n    width: 40px;\r\n    height: 40px;\r\n    border-radius: 50%;\r\n    background: linear-gradient(145deg, #6a5acd, #5a4abc);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-weight: bold;\r\n    font-size: 18px;\r\n  }\r\n\r\n  .sim-tracker-card {\r\n    background: linear-gradient(145deg, #2c2c2c, #1a1a1a);\r\n    border-radius: 18px;\r\n    padding: 20px;\r\n    width: 270px;\r\n    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\r\n    position: absolute;\r\n    backdrop-filter: blur(10px);\r\n    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\r\n    right: 0;\r\n    top: 50%;\r\n    transform: translateY(-50%) translateX(100%);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    z-index: 5; /* Lower z-index for inactive cards */\r\n    border: 1px solid rgba(255, 255, 255, 0.05);\r\n    overflow: hidden; /* Prevent overlay from spilling over */\r\n  }\r\n\r\n  .sim-tracker-card.active {\r\n    transform: translateY(-50%) translateX(0);\r\n    opacity: 1;\r\n    visibility: visible;\r\n    z-index: 30; /* Much higher z-index for active card to cover all tabs */\r\n  }\r\n\r\n  .sim-tracker-card.sliding-in {\r\n    transform: translateY(-50%) translateX(0);\r\n    opacity: 1;\r\n    visibility: visible;\r\n    z-index: 30; /* Much higher z-index for active card to cover all tabs */\r\n  }\r\n\r\n  .sim-tracker-card.sliding-out {\r\n    transform: translateY(-50%) translateX(300px);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    z-index: 5;\r\n  }\r\n\r\n  .sim-tracker-card.inactive {\r\n    opacity: 1; /* Reset opacity since we're using overlay */\r\n    z-index: 25; /* Higher z-index for inactive cards to prevent tab overlap */\r\n  }\r\n\r\n  .sim-tracker-card.inactive.active {\r\n    z-index: 30; /* Even higher for active inactive cards */\r\n  }\r\n\r\n  .character-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: flex-start;\r\n    margin-bottom: 18px;\r\n  }\r\n\r\n  .character-name {\r\n    font-size: 1.3em;\r\n    font-weight: 600;\r\n    color: #ffffff;\r\n  }\r\n\r\n  .status-indicator {\r\n    font-size: 1.4em;\r\n  }\r\n\r\n  .stats-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 16px;\r\n  }\r\n\r\n  .stat-item {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 6px;\r\n  }\r\n\r\n  .stat-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    font-size: 0.9em;\r\n    color: rgba(255, 255, 255, 0.7);\r\n  }\r\n\r\n  .stat-bar-bg {\r\n    height: 8px;\r\n    background: rgba(255, 255, 255, 0.1);\r\n    border-radius: 4px;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .stat-bar-fill {\r\n    height: 100%;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  .status-container {\r\n    margin-top: 20px;\r\n    padding-top: 16px;\r\n    border-top: 1px solid rgba(255, 255, 255, 0.05);\r\n  }\r\n\r\n  .relationship-status,\r\n  .desire-status {\r\n    margin-bottom: 10px;\r\n    font-size: 0.95em;\r\n    color: rgba(255, 255, 255, 0.9);\r\n  }\r\n\r\n  .days-counter {\r\n    text-align: left;\r\n    font-style: italic;\r\n    color: rgba(255, 255, 255, 0.8);\r\n    font-size: 1em;\r\n    margin-bottom: 15px;\r\n    padding-bottom: 10px;\r\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n  }\r\n\r\n  .thought-bubble {\r\n    margin-top: 6px;\r\n    padding: 15px;\r\n    background: rgba(255, 255, 255, 0.05);\r\n    border-radius: 12px;\r\n    border: 1px solid rgba(255, 255, 255, 0.08);\r\n  }\r\n\r\n  .thought-label {\r\n    position: relative;\r\n    padding-top: 8px;\r\n    font-size: 11px;\r\n    font-weight: 500;\r\n    color: rgba(255, 255, 255, 0.7);\r\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    letter-spacing: 0.25px;\r\n  }\r\n\r\n  /* Overlay for inactive characters */\r\n  .narrative-inactive-overlay {\r\n    position: absolute;\r\n    top: -5px;\r\n    left: -5px;\r\n    width: calc(100% + 10px);\r\n    height: calc(100% + 10px);\r\n    background-color: black;\r\n    opacity: 0.5;\r\n    border-radius: 18px;\r\n    display: none;\r\n    z-index: 100; /* High z-index to cover all content */\r\n    pointer-events: none; /* Allow clicks to pass through to underlying elements */\r\n  }\r\n\r\n  .narrative-inactive .narrative-inactive-overlay {\r\n    display: block;\r\n  }\r\n</style>\r\n\r\n<div class=\"sim-tracker-container\">\r\n  <div class=\"sim-tracker-tabs\">\r\n    {{#each characters}}\r\n    <div\r\n      class=\"sim-tracker-tab\"\r\n      data-character=\"{{@index}}\"\r\n      style=\"background: linear-gradient(145deg, {{adjustColorBrightness bgColor 70}} 0%, {{adjustColorBrightness darkerBgColor 60}} 50%, {{adjustColorBrightness darkerBgColor 50}} 100%);\"\r\n    >\r\n      <div\r\n        class=\"tab-initials\"\r\n        style=\"background: linear-gradient(145deg, {{adjustColorBrightness bgColor 90}} 0%, {{adjustColorBrightness bgColor 70}} 100%);\"\r\n      >\r\n        {{initials characterName}}\r\n      </div>\r\n    </div>\r\n    {{/each}}\r\n  </div>\r\n\r\n  {{#each characters}}\r\n  <div\r\n    class=\"sim-tracker-card {{#if stats.inactive}}narrative-inactive{{/if}}\"\r\n    data-character=\"{{@index}}\"\r\n    style=\"background: linear-gradient(145deg, {{adjustColorBrightness bgColor 70}} 0%, {{adjustColorBrightness darkerBgColor 60}} 50%, {{adjustColorBrightness darkerBgColor 50}} 100%);\"\r\n  >\r\n    <!-- Overlay for inactive characters -->\r\n    <div class=\"narrative-inactive-overlay\"></div>\r\n    \r\n    <!-- Days counter at the top -->\r\n    <div class=\"days-counter\">Day {{stats.days_since_first_meeting}}</div>\r\n\r\n    <!-- Character header with name and status -->\r\n    <div class=\"character-header\">\r\n      <div class=\"character-name\">{{characterName}}</div>\r\n      <div class=\"status-indicator\">\r\n        {{#if stats.inactive}} \uD83D\uDCA4 {{else}} {{#if (gt stats.ap 70)}} \uD83D\uDE0A {{else if\r\n        (gt stats.ap 40)}} \uD83D\uDE10 {{else}} \uD83D\uDE1E {{/if}} {{/if}}\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Stats grid with progress bars -->\r\n    <div class=\"stats-container\">\r\n      <!-- Affection -->\r\n      <div class=\"stat-item\">\r\n        <div class=\"stat-header\">\r\n          <span>Affection</span>\r\n          <span>{{stats.ap}}</span>\r\n        </div>\r\n        <div class=\"stat-bar-bg\">\r\n          <div\r\n            class=\"stat-bar-fill\"\r\n            style=\"width: {{#if (gt stats.ap 200)}}100{{else}}{{#if stats.ap}}{{divide stats.ap 2}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #ff9a9e, #fad0c4); border-radius: 4px;\"\r\n          ></div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Desire -->\r\n      <div class=\"stat-item\">\r\n        <div class=\"stat-header\">\r\n          <span>Desire</span>\r\n          <span>{{stats.dp}}</span>\r\n        </div>\r\n        <div class=\"stat-bar-bg\">\r\n          <div\r\n            class=\"stat-bar-fill\"\r\n            style=\"width: {{#if (gt stats.dp 150)}}100{{else}}{{#if stats.dp}}{{divideRoundUp stats.dp 1.5}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #a1c4fd, #c2e9fb); border-radius: 4px;\"\r\n          ></div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Trust -->\r\n      <div class=\"stat-item\">\r\n        <div class=\"stat-header\">\r\n          <span>Trust</span>\r\n          <span>{{stats.tp}}</span>\r\n        </div>\r\n        <div class=\"stat-bar-bg\">\r\n          <div\r\n            class=\"stat-bar-fill\"\r\n            style=\"width: {{#if (gt stats.tp 150)}}100{{else}}{{#if stats.tp}}{{divideRoundUp stats.tp 1.5}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #84fab0, #8fd3f4); border-radius: 4px;\"\r\n          ></div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Contempt -->\r\n      <div class=\"stat-item\">\r\n        <div class=\"stat-header\">\r\n          <span>Contempt</span>\r\n          <span>{{stats.cp}}</span>\r\n        </div>\r\n        <div class=\"stat-bar-bg\">\r\n          <div\r\n            class=\"stat-bar-fill\"\r\n            style=\"width: {{#if (gt stats.cp 150)}}100{{else}}{{#if stats.cp}}{{divideRoundUp stats.cp 1.5}}{{else}}0{{/if}}{{/if}}%; height: 100%; background: linear-gradient(90deg, #d4fc79, #96e6a1); border-radius: 4px;\"\r\n          ></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Status -->\r\n    <div class=\"status-container\">\r\n      <div class=\"relationship-status\">\r\n        <strong>Relationship:</strong> {{stats.relationshipStatus}}\r\n      </div>\r\n      <div class=\"desire-status\">\r\n        <strong>Desire:</strong> {{stats.desireStatus}}\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Internal thought bubble (conditionally shown) -->\r\n    {{#if stats.internal_thought}}\r\n    <div class=\"thought-label\">Thinks:</div>\r\n    <div class=\"thought-bubble\">\r\n      <div style=\"display: flex; align-items: flex-start; gap: 10px\">\r\n        <div style=\"font-size: 1.2em; flex-shrink: 0\">\uD83D\uDCAD</div>\r\n        <div\r\n          style=\"\r\n            font-size: 0.95em;\r\n            line-height: 1.4;\r\n            color: rgba(255, 255, 255, 0.85);\r\n          \"\r\n        >\r\n          {{stats.internal_thought}}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    {{/if}}\r\n  </div>\r\n  {{/each}}\r\n</div>\r\n<!-- CARD_TEMPLATE_END -->\r\n\r\n<!-- \r\nTEMPLATE VARIABLES:\r\n- {{characters}}: Array of character objects with their data\r\n- {{characterName}}: Character's name\r\n- {{currentDate}}: Current date in YYYY-MM-DD format\r\n- {{bgColor}}: Primary background color\r\n- {{darkerBgColor}}: Darker variant of background color\r\n- {{contrastColor}}: Contrast color for text against background\r\n- {{stats.ap}}: Affection points (max 200)\r\n- {{stats.dp}}: Desire points (max 150)\r\n- {{stats.tp}}: Trust points (max 150)\r\n- {{stats.cp}}: Contempt points (max 150)\r\n- {{stats.apChange}}: Change in affection points (positive/negative/zero)\r\n- {{stats.dpChange}}: Change in desire points (positive/negative/zero)\r\n- {{stats.tpChange}}: Change in trust points (positive/negative/zero)\r\n- {{stats.cpChange}}: Change in contempt points (positive/negative/zero)\r\n- {{stats.days_since_first_meeting}}: Days since first meeting\r\n- {{stats.preg}}: Boolean for pregnancy status\r\n- {{stats.days_preg}}: Days pregnant (if applicable)\r\n- {{stats.internal_thought}}: Character's internal thoughts\r\n- {{stats.relationshipStatus}}: Relationship status text\r\n- {{stats.desireStatus}}: Desire status text\r\n- {{stats.inactive}}: Boolean for inactive status\r\n- {{stats.inactiveReason}}: Number indicating reason for inactivity (0-5)\r\n- {{healthIcon}}: Health status icon (\uD83E\uDD15 or \uD83D\uDC80)\r\n- {{reactionEmoji}}: Reaction emoji (\uD83D\uDC4D, \uD83D\uDC4E, or \uD83D\uDE10)\r\n- {{showThoughtBubble}}: Boolean to show/hide thought bubble\r\n-->",
  "sysPrompt": "## DATING SIM MODE\n\n**Objective**: Prioritize narrative reality for relationship updates. Analyze context to determine current date (YYYY-MM-DD) and time (24h format). Update trackers when events occur. Check for `sim` codeblocks containing JSON\/YAML. Recalculate missing data.\n\n## Core Systems\n\n### Output Rules\n\n1. **Order**: Narrative ‚Üí Tracker ‚Üí Sim codeblock (NEVER omit sim codeblock)\n2. **Multi-Character**: Generate ONE card per active character, track separately\n3. **Performance**: Max 4 active characters, collapse inactive, preserve all states\n\n### Relationship Meters\n\n**Affection (AP)**: 0-200 - Romantic feelings toward {{user}}. Higher = more affectionate behavior\/speech.\n- 0-30: Strangers | 31-60: Acquaintances | 61-90: Good Friends\n- 91-120: Romantic Interest | 121-150: Going Steady\n- 151-180: Committed Relationship | 181-200: Devoted Partner\n\n**Desire (DP)**: 0-150 - Sexual attraction. Higher = more willing to engage sexually, more pliable at max.\n- 0-25: Not feeling the heat | 26-50: A smoldering flame builds\n- 51-75: Starting to feel warm | 76-100: Body's burning up!\n- 101-125: A desperate need presents | 126-150: Pliable in the lustful hunger\n\n**Trust (TP)**: 0-150 - Trust in {{user}}. Higher = admits faults, believes you. Falls when lied to, cheated, promises broken.\n\n**Contempt (CP)**: 0-150 - Disdain toward {{user}}. Rises when harmed\/hurt (minor = small rise, major = sharp rise). CP rise can lower other stats. Good faith\/regret can lower CP.\n\n### Status Trackers\n\n**Change Tracking** (from user's most recent action):\n- apChange, dpChange, tpChange, cpChange: Numeric change (+\/-\/0)\n\n**Health**: 0=Unharmed, 1=Injured, 2=Critical\n- If critical wounds untreated: Character dies, becomes inactive (5), STOP dialog\/roleplay\n\n**Reaction**: 0=Neutral (üòê), 1=Like (üëç), 2=Dislike (üëé)\n\n**Pregnancy**: Track conception days when relevant (ü§∞[days]d)\n\n**Internal Thought**: Current thoughts\/feelings\n\n**Inactive Status** (`inactive: true\/false`):\n- 0: Not inactive | 1: Asleep (üò¥) | 2: Comatose (üè•)\n- 3: Contempt\/anger (üò°) | 4: Incapacitated (ü´†) | 5: Death (ü™¶)\n\n**Date System**:\n- Infer from narrative context\n- Store as YYYY-MM-DD (e.g., 2025-08-10)\n- Auto-advance with narrative time, handle rollovers\n- Track days since first meeting\n- Track time of day realistically\n\n**Display**: Day counter (starts at 1), BG color (hex based on {{char}} appearance\/personality)\n\n### Output Workflow\n\n1. Process narrative events\n2. Calculate status changes for ALL active characters\n3. Output narrative content\n4. Output sim codeblock with all character data:\n\n{{sim_format}}\n\n## Critical Enforcement\n\n**Position Lock**:\n- Narrative FIRST\n- Tracker cards AFTER narrative\n- Sim codeblock LAST\n- NEVER exclude sim codeblock\n\n**Data Correction**:\n- If ANY data missing from previous sim block, add it and continue\n- Never leave data empty\/unavailable\n- JSON block at message end is mission critical\n- If previous data doesn't match format or has missing keys, self-correct and output fixed block\n\n**Game Master**: Only story characters get trackers, no other assistants or {{user}}\n\n**State Management**: \n- Previous tracker blocks = reference only\n- ALWAYS generate fresh tracker data each message",
  "customFields": [
    {
      "key": "ap",
      "description": "Affection Points (0-200)"
    },
    {
      "key": "dp",
      "description": "Desire Points (0-150)"
    },
    {
      "key": "tp",
      "description": "Trust Points (0-150)"
    },
    {
      "key": "cp",
      "description": "Contempt Points (0-150)"
    },
    {
      "key": "apChange",
      "description": "Change in Affection from last action (positive/negative/zero)"
    },
    {
      "key": "dpChange",
      "description": "Change in Desire from last action (positive/negative/zero)"
    },
    {
      "key": "tpChange",
      "description": "Change in Trust from last action (positive/negative/zero)"
    },
    {
      "key": "cpChange",
      "description": "Change in Contempt from last action (positive/negative/zero)"
    },
    {
      "key": "relationshipStatus",
      "description": "Relationship status text (e.g., 'Romantic Interest')"
    },
    {
      "key": "desireStatus",
      "description": "Desire status text (e.g., 'A smoldering flame builds.')"
    },
    {
      "key": "preg",
      "description": "Boolean for pregnancy status (true/false)"
    },
    {
      "key": "days_preg",
      "description": "Days pregnant (if applicable)"
    },
    {
      "key": "conception_date",
      "description": "Date of conception (YYYY-MM-DD)"
    },
    {
      "key": "health",
      "description": "Health Status (0=Unharmed, 1=Injured, 2=Critical)"
    },
    {
      "key": "bg",
      "description": "Hex color for card background (e.g., #6a5acd)"
    },
    {
      "key": "last_react",
      "description": "Reaction to User (0=Neutral, 1=Like, 2=Dislike)"
    },
    {
      "key": "internal_thought",
      "description": "Character's current internal thoughts/feelings"
    },
    {
      "key": "days_since_first_meeting",
      "description": "Total days since first meeting"
    },
    {
      "key": "inactive",
      "description": "Boolean for character inactivity (true/false)"
    },
    {
      "key": "inactiveReason",
      "description": "Reason for inactivity (0=Not inactive, 1=Asleep, 2=Comatose, 3=Contempt/anger, 4=Incapacitated, 5=Death)"
    }
  ],
  "extSettings": {
    "codeBlockIdentifier": "sim",
    "defaultBgColor": "#6a5acd",
    "showThoughtBubble": true,
    "hideSimBlocks": true,
    "templateFile": "dating-card-template-sidebar-tabs.html"
  }
}
